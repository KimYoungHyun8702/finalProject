<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.mugs.config.mapper.professorSubjectMapper">

	<resultMap id="professor_subject-resultmap" type="professorSubject">
		<id column="pro_subject_id" property="proSubjectId" />
		<result column="pro_subject_semester" property="proSubjectSemester" />
		<result column="pro_subject_year" property="proSubjectYear" />
		<result column="pro_id" property="proId"/>
		<result column="subject_id" property="subjectId"/>
	</resultMap>
	
	<resultMap id="professor_subject-subject-resultmap" type="professorSubject" extends="professor_subject-resultmap">
		<association property="subject" resultMap="com.mugs.config.mapper.subjectMapper.subject-basic-resultmap"/>
	</resultMap>
	
	
	<sql id="select-professor_subject">
	SELECT pro_subject_id, pro_subject_semester, pro_subject_year
	FROM professor_subject		
	</sql>
	
	<select id="selectProfessorSubjectList" resultMap="professor_subject-resultmap">
		<include refid="select-professor_subject"/>
	</select>

	<select id="selectProfessorSubjectById" resultMap="professor_subject-resultmap"
		parameterType="int">
		<include refid="select-professor_subject"/>
		WHERE pro_subject_id = #{value}
	</select>

	<insert id="insertProfessorSubject" parameterType="professorSubject">
		INSERT INTO professor_subject
		VALUES(#{proSubjectId},#{proSubjectSemester},#{proSubjectYear})
	</insert>

	<delete id="deleteProfessorSubjectById" parameterType="int">
		DELETE FROM professor_subject
		WHERE pro_subject_id = #{value}
	</delete>

	<update id="updateProfessorSubject" parameterType="professorSubject">
		UPDATE professor_subject
		SET
		pro_subject_semester = #{proSubjectSemester}, 
		pro_subject_year = #{proSubjectYear}
		WHERE pro_subject_id = #{proSubjectId}
	</update>
	
	<!-- 담당과목 테이블에서 교수id로 담당과목을 찾는다(과목 조인) -->
	<select id="selectProfessorSubjectListJoinByProId" resultMap="professor_subject-subject-resultmap" parameterType="string">
	SELECT 
	p.pro_subject_id, 
	p.pro_subject_semester, 
	p.pro_subject_year, 
	p.pro_id, 
	p.subject_id,
	s.subject_id,
	s.subject_name,
	s.subject_time,
	s.subject_type,
	s.subject_credit,
	s.subject_capacity,
	s.subject_request,
	s.subject_grade,
	s.subject_class,
	s.subject_close_class,
	s.subject_semester,
	s.major_id,
	s.lecture_id
	FROM professor_subject p, subject s 	
	WHERE p.subject_id = s.subject_id
	AND pro_id = #{value}
	</select>
	
</mapper>